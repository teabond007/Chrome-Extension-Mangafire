import{F as y,S as M,B as x,T as g,C as E}from"./config-sTLp4FTN.js";import{e as h,r as l,S as s}from"./storage-schema-DbDZlffU.js";function k(){const f=l(!1),d=l(!0),u=l("cloudy-dark"),c=l({...M}),n=l({...x}),e=l({...y}),m=l("medium"),p=l([]),i=l({}),S=h(()=>g[u.value]||g["cloudy-dark"]),R=h(()=>E[m.value]||E.medium),C=h(()=>Object.entries(g).map(([a,o])=>({id:a,name:o.name}))),t=l({general:{markHomePage:!1,syncAndMarkRead:!1,familyFriendly:!1},automation:{smartAutoComplete:!1,smartInactivityFade:!1,smartResume:!1},reader:{enhancements:!0,widthFix:!1,nextChapter:!0},highlights:{mangadex:!0,webtoons:!0},appearance:{theme:"cloudy-dark",accentColor:"",libraryData:{progressBars:!0}},dates:{}});async function T(){d.value=!0;try{const a=await chrome.storage.local.get([s.THEME,s.STATUS_COLORS,s.BORDER_STYLE,s.BORDER_SIZE,s.CUSTOM_MARKERS,"features","cardSize"]);a[s.THEME]&&(u.value=a[s.THEME]),a.features&&(e.value={...y,...a.features}),t.value.general.markHomePage=e.value.markHomePage,t.value.general.syncAndMarkRead=e.value.syncAndMarkRead,t.value.general.familyFriendly=e.value.familyFriendly,t.value.automation.smartAutoComplete=e.value.smartAutoComplete,t.value.automation.smartInactivityFade=e.value.smartInactivityDim,t.value.automation.smartResume=e.value.smartResume,t.value.reader.enhancements=e.value.readerEnhancements,t.value.reader.widthFix=e.value.readerWidthFix,t.value.reader.nextChapter=e.value.readerNextChapter,t.value.highlights.mangadex=e.value.mangadexHighlight,t.value.highlights.webtoons=e.value.webtoonsHighlight,t.value.appearance.theme=u.value,t.value.appearance.libraryData.progressBars=e.value.progressBadges,f.value=!0,console.log("[useSettings] ✓ Settings loaded")}catch(a){console.error("[useSettings] Failed to load settings:",a)}finally{d.value=!1}}async function F(a){e.value.markHomePage=a.general.markHomePage,e.value.syncAndMarkRead=a.general.syncAndMarkRead,e.value.familyFriendly=a.general.familyFriendly,e.value.smartAutoComplete=a.automation.smartAutoComplete,e.value.smartInactivityDim=a.automation.smartInactivityFade,e.value.smartResume=a.automation.smartResume,e.value.readerEnhancements=a.reader.enhancements,e.value.readerWidthFix=a.reader.widthFix,e.value.readerNextChapter=a.reader.nextChapter,e.value.mangadexHighlight=a.highlights.mangadex,e.value.webtoonsHighlight=a.highlights.webtoons,e.value.progressBadges=a.appearance.libraryData.progressBars,u.value=a.appearance.theme,await v()}async function v(){try{await chrome.storage.local.set({[s.THEME]:u.value,[s.STATUS_COLORS]:c.value,[s.BORDER_STYLE]:n.value.style,[s.BORDER_SIZE]:n.value.size,[s.CUSTOM_MARKERS]:p.value,features:e.value,cardSize:m.value,platformSettings:i.value}),console.log("[useSettings] ✓ Settings saved")}catch(a){console.error("[useSettings] Failed to save settings:",a)}}async function A(a,o){const r=a.split(".");r.length===1?a==="theme"?u.value=o:a==="cardSize"&&(m.value=o):r[0]==="border"?n.value[r[1]]=o:r[0]==="features"?e.value[r[1]]=o:r[0]==="statusColors"?c.value[r[1]]=o:r[0]==="platforms"&&r.length===3&&(i.value[r[1]]||(i.value[r[1]]={}),i.value[r[1]][r[2]]=o),await v()}return{settings:t,isLoaded:f,isLoading:d,theme:u,statusColors:c,border:n,features:e,cardSize:m,customMarkers:p,platforms:i,themeConfig:S,cardDimensions:R,availableThemes:C,loadSettings:T,saveSettings:v,updateSettings:F,updateSetting:A,getStatusColor,isFeatureEnabled,toggleFeature,addCustomMarker,removeCustomMarker,applyTheme,resetToDefaults}}export{k as u};
