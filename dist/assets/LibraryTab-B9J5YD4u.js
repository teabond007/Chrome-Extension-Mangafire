import{u as N}from"./useLibrary-DSwFYHO5.js";import{v as F,V as O}from"./storage-schema-CQTxiJkW.js";import{G as k}from"./GlassCard-zdn37Q_h.js";import{B as S}from"./BaseButton-DrEgG_qK.js";import{_ as C,c as l,g as n,e as p,a as e,f as h,t as o,B as U,r as B,n as q,b as u,A as b,u as i,C as V,d as j,F as D,i as J}from"./_plugin-vue_export-helper-DrK4Gf5m.js";import{C as P}from"./CrystalSelect-DnEneQyy.js";/* empty css                                                                   *//* empty css                                                                      */const z={key:0,class:"input-label"},G={key:0,class:"required"},M={class:"input-container"},Q={key:0,class:"input-icon"},Z=["value","type","placeholder","disabled","required"],H={key:1,class:"input-spinner"},K={key:1,class:"input-error"},W={key:2,class:"input-hint"},X={__name:"BaseInput",props:{modelValue:{type:[String,Number],default:""},type:{type:String,default:"text"},label:{type:String,default:""},placeholder:{type:String,default:""},icon:{type:String,default:""},error:{type:String,default:""},hint:{type:String,default:""},disabled:{type:Boolean,default:!1},required:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(s){const c=B(!1),m=B(null);return(y,r)=>(n(),l("div",{class:q(["base-input-wrapper",{"has-error":s.error,"is-disabled":s.disabled}])},[s.label?(n(),l("label",z,[h(o(s.label)+" ",1),s.required?(n(),l("span",G,"*")):p("",!0)])):p("",!0),e("div",M,[s.icon?(n(),l("span",Q,o(s.icon),1)):p("",!0),e("input",U({ref_key:"inputRef",ref:m,value:s.modelValue,type:s.type,placeholder:s.placeholder,disabled:s.disabled,required:s.required,class:["base-input",{"has-icon":s.icon}]},y.$attrs,{onInput:r[0]||(r[0]=v=>y.$emit("update:modelValue",v.target.value)),onFocus:r[1]||(r[1]=v=>c.value=!0),onBlur:r[2]||(r[2]=v=>c.value=!1)}),null,16,Z),s.loading?(n(),l("div",H)):p("",!0)]),s.error?(n(),l("span",K,o(s.error),1)):s.hint?(n(),l("span",W,o(s.hint),1)):p("",!0)],2))}},Y=C(X,[["__scopeId","data-v-50433b2a"]]),ee={class:"tab-content"},te={class:"stats-grid"},se={class:"stat-item total"},ae={class:"stat-value"},le={class:"stat-item reading"},ne={class:"stat-value"},oe={class:"stat-item completed"},re={class:"stat-value"},ie={class:"stat-item planned"},de={class:"stat-value"},ue={class:"actions-row"},ce={class:"action-buttons"},pe={class:"actions-row danger-zone"},me={class:"action-buttons"},ye={class:"library-controls"},fe={class:"search-box"},be={class:"filter-box"},ve={class:"entries-preview"},ge={key:0,class:"empty-state"},he={key:1,class:"entries-list"},_e={class:"entry-title"},ke={class:"entry-meta"},Se={key:0,class:"entry-source"},Be=["data-status"],Le={key:0,class:"more-entries"},$e={__name:"LibraryTab",setup(s){const{stats:c,filteredEntries:m,searchQuery:y,statusFilter:r,clearLibrary:v,entriesArray:w,entries:I}=N(),L=B(null),A=j(()=>[{label:"All Statuses",value:"ALL"},...O.map(d=>({label:d,value:d}))]),R=()=>{const d=JSON.stringify(w.value,null,2),t=new Blob([d],{type:"application/json"}),a=URL.createObjectURL(t),g=document.createElement("a");g.href=a,g.download=`mangafire-backup-${new Date().toISOString().split("T")[0]}.json`,g.click(),URL.revokeObjectURL(a)},x=()=>{L.value.click()},E=d=>{const t=d.target.files[0];if(!t)return;const a=new FileReader;a.onload=async g=>{try{const f=JSON.parse(g.target.result);if(Array.isArray(f)){const _=f.filter(F),$=f.length-_.length;confirm(`Found ${_.length} valid entries.${$>0?` (${$} skipped)`:""}
This will REPLACE your current library. Are you sure?`)&&(I.value=_,alert("Library imported successfully!"))}else alert("Invalid backup format: root must be an array.")}catch(f){console.error(f),alert("Failed to parse backup file: "+f.message)}d.target.value=""},a.readAsText(t)},T=()=>{confirm("Are you sure you want to delete all library entries? This cannot be undone.")&&v()};return(d,t)=>(n(),l("div",ee,[u(k,{title:"Library Statistics",subtitle:"Overview of your reading progress"},{default:b(()=>[e("div",te,[e("div",se,[e("span",ae,o(i(c).total),1),t[2]||(t[2]=e("span",{class:"stat-label"},"Total Entries",-1))]),e("div",le,[e("span",ne,o(i(c).reading),1),t[3]||(t[3]=e("span",{class:"stat-label"},"Reading",-1))]),e("div",oe,[e("span",re,o(i(c).completed),1),t[4]||(t[4]=e("span",{class:"stat-label"},"Completed",-1))]),e("div",ie,[e("span",de,o(i(c).planToRead),1),t[5]||(t[5]=e("span",{class:"stat-label"},"Plan to Read",-1))])])]),_:1}),u(k,{title:"Data Management",subtitle:"Backup and restore your library"},{default:b(()=>[e("div",ue,[t[8]||(t[8]=e("div",{class:"action-info"},[e("h3",null,"Backup & Restore"),e("p",null,"Export your library to a JSON file or import from a backup.")],-1)),e("div",ce,[u(S,{variant:"secondary",icon:"ðŸ“¥",onClick:R},{default:b(()=>[...t[6]||(t[6]=[h(" Export Backup ",-1)])]),_:1}),u(S,{variant:"secondary",icon:"ðŸ“¤",onClick:x},{default:b(()=>[...t[7]||(t[7]=[h(" Import Backup ",-1)])]),_:1}),e("input",{type:"file",ref_key:"fileInput",ref:L,accept:".json",style:{display:"none"},onChange:E},null,544)])]),e("div",pe,[t[10]||(t[10]=e("div",{class:"action-info"},[e("h3",null,"Danger Zone"),e("p",null,"Irreversible actions for data management.")],-1)),e("div",me,[u(S,{variant:"danger",icon:"ðŸ—‘ï¸",onClick:T},{default:b(()=>[...t[9]||(t[9]=[h(" Clear Library ",-1)])]),_:1})])])]),_:1}),u(k,{title:"Library Browser",subtitle:"Browse and manage entries"},{default:b(()=>[e("div",ye,[e("div",fe,[u(Y,{modelValue:i(y),"onUpdate:modelValue":t[0]||(t[0]=a=>V(y)?y.value=a:null),placeholder:"Search library...",icon:"ðŸ”"},null,8,["modelValue"])]),e("div",be,[u(P,{modelValue:i(r),"onUpdate:modelValue":t[1]||(t[1]=a=>V(r)?r.value=a:null),options:A.value,placeholder:"All Statuses",searchable:""},null,8,["modelValue","options"])])]),e("div",ve,[i(m).length===0?(n(),l("div",ge," No entries found matching your criteria. ")):(n(),l("div",he,[(n(!0),l(D,null,J(i(m).slice(0,10),a=>(n(),l("div",{key:a.id,class:"entry-item"},[e("span",_e,o(a.title),1),e("div",ke,[a.source?(n(),l("span",Se,o(a.source),1)):p("",!0),e("span",{class:"entry-status box-badge","data-status":a.status},o(a.status),9,Be)])]))),128)),i(m).length>10?(n(),l("div",Le," +"+o(i(m).length-10)+" more entries ",1)):p("",!0)]))])]),_:1})]))}},Te=C($e,[["__scopeId","data-v-e91ac3ac"]]);export{Te as default};
