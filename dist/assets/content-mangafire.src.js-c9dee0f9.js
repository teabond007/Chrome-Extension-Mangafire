import{C as m,R as f,O as g}from"./reader-enhancements-86b09aa0.js";const u={id:"mangafire",name:"MangaFire",unitName:"chapter",PREFIX:"",selectors:{card:".unit, .swiper-slide, #top-trending .swiper-slide",cardTitle:".info a, .info h6 a, .above a",cardLink:'a[href*="/manga/"]',cardCover:".poster img, img"},extractCardData(e){var i;let t="",r="",a="";const n=e.querySelector(".info a")||e.querySelector(".info h6 a")||e.querySelector(".above a");n&&(t=((i=n.textContent)==null?void 0:i.trim())||"");const o=e.querySelector(this.selectors.cardLink);return o&&(r=o.href,a=this.extractSlug(r)),{id:a,title:t,slug:a,url:r}},extractSlug(e){if(!e)return"";try{const t=e.match(/\/manga\/([^/?#]+)/);return t?t[1]:""}catch{return""}},applyBorder(e,t,r,a){let n=e;if(e.classList.contains("swiper-slide")){(e.querySelector(".swiper-inner")||e).style.setProperty("border-left",`${r}px ${a} ${t}`,"important");return}const o=e.closest("li");o&&(n=o),n.style.setProperty("border",`${r}px ${a} ${t}`,"important"),n.style.setProperty("border-radius","8px","important"),n.style.setProperty("box-sizing","border-box","important")},getBadgePosition(){return{bottom:"4px",left:"4px"}},buildChapterUrl(e,t){return null},isReaderPage(){return window.location.href.includes("/read/")},parseUrl(e){const t=e.match(/\/read\/([^/]+)\.?(\d*)\/(?:[^/]+\/)?chapter-([^/?#]+)/);return t?{slug:t[1],id:t[2]||null,chapterNo:parseFloat(t[3])}:null},goToNextChapter(){const e=document.querySelector('a.btn-next, .chapter-nav .next, [data-direction="next"]');e&&e.click()},goToPrevChapter(){const e=document.querySelector('a.btn-prev, .chapter-nav .prev, [data-direction="prev"]');e&&e.click()},exitReader(){const e=document.querySelector('a.manga-link, a[href*="/manga/"]');e?window.location.href=e.href:window.history.back()}};function p(e){if(!e)return{title:"",chapter:"",slugWithId:""};const t=e.match(/\/read\/([^/]+)\/(?:[^/]+\/)?chapter-([^/?#]+)/);if(!t)return{title:"",chapter:"",slugWithId:""};const r=t[1],a=t[2];let n=r.includes(".")?r.substring(0,r.lastIndexOf(".")):r;return n.endsWith("gg")&&(n=n.slice(0,-1)),{title:n,chapter:a,slugWithId:r}}function d(){var n;if(!((n=chrome.runtime)!=null&&n.id))return;const e=window.location.href,{title:t,chapter:r,slugWithId:a}=p(e);!t||!r||chrome.storage.local.get(["savedReadChapters"],o=>{if(chrome.runtime.lastError)return;let i=o.savedReadChapters||{};i[t]||(i[t]=[]),i[t].includes(r)||(i[t].push(r),chrome.storage.local.set({savedReadChapters:i},()=>{chrome.runtime.lastError||c(`Saved chapter ${r} for ${t}`)})),chrome.runtime.sendMessage({type:"autoSyncEntry",title:t,chapter:r,slugWithId:a,readChapters:i[t].length,source:"mangafire"},()=>{chrome.runtime.lastError})})}function c(e){var r;if(!((r=chrome.runtime)!=null&&r.id))return;const t=typeof e=="object"?JSON.stringify(e):e;chrome.runtime.sendMessage({type:"log",text:`[MangaFire] ${t}`},()=>{chrome.runtime.lastError})}function b(){if(document.getElementById("bmh-mangafire-styles"))return;const e=document.createElement("style");e.id="bmh-mangafire-styles",e.textContent=`
        @keyframes bmh-pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
        }
    `,document.head.appendChild(e),g.injectStyles()}async function y(){var l;if(!((l=chrome.runtime)!=null&&l.id))return;c("MangaFire CardEnhancer v3.8.0 (Bundled) initializing..."),b();const e=await new Promise(s=>{chrome.storage.local.get(["MangaFireHighlightEnabled","MangaFireQuickActionsEnabled","CustomBorderSize","CustomBorderSizefeatureEnabled","CustomBookmarksfeatureEnabled","customBookmarks","MangaFireShowProgress"],h=>{if(chrome.runtime.lastError){s({});return}s(h)})});if(e.MangaFireHighlightEnabled===!1){c("Highlighting disabled");return}const t=new m(u,{highlighting:!0,progressBadges:e.MangaFireShowProgress!==!1,quickActions:e.MangaFireQuickActionsEnabled!==!1,CustomBorderSize:e.CustomBorderSizefeatureEnabled?e.CustomBorderSize:4,CustomBookmarksfeatureEnabled:e.CustomBookmarksfeatureEnabled,customBookmarks:e.customBookmarks}),r=await t.enhanceAll();c(`Enhanced ${r} cards (Quick Actions: ${e.MangaFireQuickActionsEnabled!==!1?"ON":"OFF"})`),window.location.href.includes("/read/")&&(d(),new f(u).init(),c("Reader enhancements initialized"));let a;new MutationObserver(()=>{clearTimeout(a),a=setTimeout(()=>t.enhanceAll(),200)}).observe(document.body,{childList:!0,subtree:!0});let o=location.href;new MutationObserver(()=>{location.href!==o&&(o=location.href,document.querySelectorAll("[data-bmh-enhanced]").forEach(s=>{delete s.dataset.bmhEnhanced}),setTimeout(()=>t.enhanceAll(),500),location.href.includes("/read/")&&setTimeout(d,1e3))}).observe(document,{subtree:!0,childList:!0})}window.addEventListener("load",()=>{setTimeout(y,500)});
