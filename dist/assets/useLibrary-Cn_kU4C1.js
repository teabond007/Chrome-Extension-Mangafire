import{B as S,r as f,C as A,w,b,z as C,e as v,S as R}from"./storage-schema-5IIhgyd6.js";(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const t of r)if(t.type==="childList")for(const o of t.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function l(r){const t={};return r.integrity&&(t.integrity=r.integrity),r.referrerPolicy&&(t.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?t.credentials="include":r.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(r){if(r.ep)return;r.ep=!0;const t=l(r);fetch(r.href,t)}})();/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */const D=Symbol();var g;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(g||(g={}));function _(){const e=S(!0),c=e.run(()=>f({}));let l=[],s=[];const r=A({install(t){r._a=t,t.provide(D,r),t.config.globalProperties.$pinia=r,s.forEach(o=>l.push(o)),s=[]},use(t){return this._a?l.push(t):s.push(t),this},_p:l,_a:null,_e:e,_s:new Map,state:c});return r}function O(e,c){const l=f(c);let s=!1;async function r(){try{const o=await chrome.storage.local.get(e);o[e]!==void 0&&(s=!0,l.value=o[e],s=!1)}catch(o){console.error(`[useSyncedStorage] Failed to load ${e}:`,o)}}function t(o,p){p==="local"&&o[e]&&(s=!0,l.value=o[e].newValue,s=!1)}return w(l,async o=>{if(!s)try{await chrome.storage.local.set({[e]:o})}catch(p){console.error(`[useSyncedStorage] Failed to save ${e}:`,p)}},{deep:!0}),b(()=>{r(),chrome.storage.onChanged.addListener(t)}),C(()=>{chrome.storage.onChanged.removeListener(t)}),l}function E(){const e=O(R.LIBRARY,[]),c=f(""),l=f("ALL"),s=f("lastReadDate"),r=f(!0),t=v(()=>Array.isArray(e.value)?e.value:[]),o=v(()=>{let a=[...t.value];if(l.value!=="ALL"&&(a=a.filter(u=>u.status===l.value)),c.value.trim()){const u=c.value.toLowerCase();a=a.filter(i=>i.title&&i.title.toLowerCase().includes(u)||i.slug&&i.slug.toLowerCase().includes(u))}return a.sort((u,i)=>{const n=u[s.value],d=i[s.value];return n===d?0:n==null?1:d==null?-1:typeof n=="string"?r.value?d.localeCompare(n):n.localeCompare(d):r.value?d-n:n-d}),a}),p=v(()=>({total:t.value.length,reading:t.value.filter(a=>a.status==="Reading").length,completed:t.value.filter(a=>a.status==="Completed").length,planToRead:t.value.filter(a=>a.status==="Plan to Read").length,onHold:t.value.filter(a=>a.status==="On-Hold").length,dropped:t.value.filter(a=>a.status==="Dropped").length,rereading:t.value.filter(a=>a.status==="Re-reading").length}));function h(a,u){if(!Array.isArray(e.value))return;const i=e.value.findIndex(n=>n.id===a);if(i!==-1){const n=e.value[i];n.status=u,n.updatedAt=Date.now(),n.lastUpdated=Date.now(),e.value=[...e.value]}}function m(a,u){if(!Array.isArray(e.value))return;const i=e.value.findIndex(n=>n.id===a);if(i!==-1){const n=e.value[i];n.personalData||(n.personalData={}),n.personalData.rating=u,n.lastUpdated=Date.now(),e.value=[...e.value]}}function y(a){Array.isArray(e.value)&&(e.value=e.value.filter(u=>u.id!==a))}function L(){e.value=[]}return{entries:e,entriesArray:t,filteredEntries:o,stats:p,searchQuery:c,statusFilter:l,sortBy:s,sortDesc:r,updateStatus:h,updateRating:m,removeEntry:y,clearLibrary:L}}export{_ as c,E as u};
